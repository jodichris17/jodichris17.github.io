"use strict";(self.webpackChunkjodichris_com=self.webpackChunkjodichris_com||[]).push([[195],{6774:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"aws-cli-cheatsheet","title":"AWS CLI Cheat Sheet","description":"Published on April 14, 2021","source":"@site/docs/aws-cli-cheatsheet.md","sourceDirName":".","slug":"/aws-cli-cheatsheet","permalink":"/docs/aws-cli-cheatsheet","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"AWS CLI Cheat Sheet"},"sidebar":"docs","previous":{"title":"Cisco Cheatsheet","permalink":"/docs/cisco-cheatsheet"},"next":{"title":"GKE Cheatsheet","permalink":"/docs/gcp-gke-cheatsheet"}}');var a=i(4848),r=i(8453);const l={title:"AWS CLI Cheat Sheet"},c="Table of Contents",t={},d=[{value:"Describing volumes",id:"describing-volumes",level:2},{value:"Describing volumes using a different aws user profile",id:"describing-volumes-using-a-different-aws-user-profile",level:2},{value:"Listing Available Volumes IDs",id:"listing-available-volumes-ids",level:2},{value:"Deleting a Volume",id:"deleting-a-volume",level:2},{value:"Deleting Unused Volumes.. Think Before You Type :-)",id:"deleting-unused-volumes-think-before-you-type--",level:2},{value:"Creating a Snapshot",id:"creating-a-snapshot",level:2},{value:"Creating an Image (AMI)",id:"creating-an-image-ami",level:2},{value:"Creating AMI Without Rebooting the Machine",id:"creating-ami-without-rebooting-the-machine",level:2},{value:"Listing AMI(s)",id:"listing-amis",level:2},{value:"Describing AMI(s)",id:"describing-amis",level:2},{value:"Listing Amazon AMIs",id:"listing-amazon-amis",level:2},{value:"Using Filters",id:"using-filters",level:2},{value:"List Functions",id:"list-functions",level:2},{value:"Describe a Function",id:"describe-a-function",level:2},{value:"Invoke a Function",id:"invoke-a-function",level:2},{value:"Update a Function Code",id:"update-a-function-code",level:2},{value:"Publish a Version",id:"publish-a-version",level:2},{value:"List Layers",id:"list-layers",level:2},{value:"List Aliases of a Function",id:"list-aliases-of-a-function",level:2},{value:"Describe an Alias",id:"describe-an-alias",level:2},{value:"Create an Alias",id:"create-an-alias",level:2},{value:"Delete an Alias",id:"delete-an-alias",level:2},{value:"List Function Tags",id:"list-function-tags",level:2},{value:"Delete a Function",id:"delete-a-function",level:2},{value:"Using AWS Lambda with Scheduled Events",id:"using-aws-lambda-with-scheduled-events",level:2},{value:"List Users",id:"list-users",level:2},{value:"List Policies",id:"list-policies",level:2},{value:"List Groups",id:"list-groups",level:2},{value:"Get Users in a  Group",id:"get-users-in-a--group",level:2},{value:"Describing a Policy",id:"describing-a-policy",level:2},{value:"List Access Keys",id:"list-access-keys",level:2},{value:"List Keys",id:"list-keys",level:2},{value:"List the Access Key IDs for an IAM User",id:"list-the-access-key-ids-for-an-iam-user",level:2},{value:"List the SSH Public Keys for a User",id:"list-the-ssh-public-keys-for-a-user",level:2},{value:"Listing Buckets",id:"listing-buckets",level:2},{value:"Listing Only Bucket Names",id:"listing-only-bucket-names",level:2},{value:"Getting a Bucket Region",id:"getting-a-bucket-region",level:2},{value:"Listing the Content of a Bucket",id:"listing-the-content-of-a-bucket",level:2},{value:"Syncing a Local Folder with a Bucket",id:"syncing-a-local-folder-with-a-bucket",level:2},{value:"Copying Files",id:"copying-files",level:2},{value:"Copying Folders",id:"copying-folders",level:2},{value:"Removing a File from a Bucket",id:"removing-a-file-from-a-bucket",level:2},{value:"Deleting a Bucket",id:"deleting-a-bucket",level:2},{value:"Emptying a Bucket",id:"emptying-a-bucket",level:2},{value:"Making a Public File Private",id:"making-a-public-file-private",level:2},{value:"Making a Public bucket Private",id:"making-a-public-bucket-private",level:2},{value:"Creating A VPC",id:"creating-a-vpc",level:2},{value:"Allowing DNS hostnames",id:"allowing-dns-hostnames",level:2},{value:"Creating A Subnet",id:"creating-a-subnet",level:2},{value:"Auto Assigning Public IPs To Instances In A Public Subnet",id:"auto-assigning-public-ips-to-instances-in-a-public-subnet",level:2},{value:"Creating An IGW",id:"creating-an-igw",level:2},{value:"Attaching An IGW to A VPC",id:"attaching-an-igw-to-a-vpc",level:2},{value:"Setting Up A NAT Gateway",id:"setting-up-a-nat-gateway",level:2},{value:"Creating A Public Route Table",id:"creating-a-public-route-table",level:2},{value:"Creating A Private Route Tables",id:"creating-a-private-route-tables",level:2},{value:"Listing Distributions",id:"listing-distributions",level:2},{value:"Invalidating Files From a Distribution",id:"invalidating-files-from-a-distribution",level:2},{value:"Sync a Local Folder with a CLoudFront Distribution",id:"sync-a-local-folder-with-a-cloudfront-distribution",level:2},{value:"Sync and Invalidate at the Same Time:",id:"sync-and-invalidate-at-the-same-time",level:2},{value:"List Databases",id:"list-databases",level:2},{value:"List Public Databases",id:"list-public-databases",level:2},{value:"List Non Protected Databases (DeletionProtection)",id:"list-non-protected-databases-deletionprotection",level:2},{value:"Describe the Automated Backups for a DB Instance",id:"describe-the-automated-backups-for-a-db-instance",level:2},{value:"Create a DB Cluster",id:"create-a-db-cluster",level:2},{value:"Create a DB Instance",id:"create-a-db-instance",level:2},{value:"Create a DB Security Group",id:"create-a-db-security-group",level:2},{value:"Create a Read Replica",id:"create-a-read-replica",level:2},{value:"Create a Custom DB Cluster Endpoint",id:"create-a-custom-db-cluster-endpoint",level:2},{value:"Apply Tag to a DB",id:"apply-tag-to-a-db",level:2},{value:"Create a Cluster Snapshot",id:"create-a-cluster-snapshot",level:2},{value:"Create a CloudWatch Alarm for a DB Instance",id:"create-a-cloudwatch-alarm-for-a-db-instance",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Published on April 14, 2021"}),"\n",(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"table-of-contents",children:"Table of Contents"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#volumes",children:"Volumes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describing-volumes",children:"Describing volumes"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describing-volumes-using-a-different-aws-user-profile",children:"Describing volumes using a different aws user profile"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-available-volumes-ids",children:"Listing Available Volumes IDs"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#deleting-a-volume",children:"Deleting a Volume"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#deleting-unused-volumes-think-before-you-type--",children:"Deleting Unused Volumes.. Think Before You Type :-)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-a-snapshot",children:"Creating a Snapshot"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-an-image-ami",children:"Creating an Image (AMI)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-ami-without-rebooting-the-machine",children:"Creating AMI Without Rebooting the Machine"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#amis",children:"AMIs"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-amis",children:"Listing AMI(s)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describing-amis",children:"Describing AMI(s)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-amazon-amis",children:"Listing Amazon AMIs"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#using-filters",children:"Using Filters"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#lambda",children:"Lambda"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-functions",children:"List Functions"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describe-a-function",children:"Describe a Function"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#invoke-a-function",children:"Invoke a Function"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#update-a-function-code",children:"Update a Function Code"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#publish-a-version",children:"Publish a Version"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-layers",children:"List Layers"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-aliases-of-a-function",children:"List Aliases of a Function"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describe-an-alias",children:"Describe an Alias"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-an-alias",children:"Create an Alias"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#delete-an-alias",children:"Delete an Alias"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-function-tags",children:"List Function Tags"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#delete-a-function",children:"Delete a Function"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#using-aws-lambda-with-scheduled-events",children:"Using AWS Lambda with Scheduled Events"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#iam",children:"IAM"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-users",children:"List Users"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-policies",children:"List Policies"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-groups",children:"List Groups"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#get-users-in-a--group",children:"Get Users in a  Group"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describing-a-policy",children:"Describing a Policy"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-access-keys",children:"List Access Keys"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-keys",children:"List Keys"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-the-access-key-ids-for-an-iam-user",children:"List the Access Key IDs for an IAM User"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-the-ssh-public-keys-for-a-user",children:"List the SSH Public Keys for a User"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#s3-api",children:"S3 API"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-buckets",children:"Listing Buckets"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-only-bucket-names",children:"Listing Only Bucket Names"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getting-a-bucket-region",children:"Getting a Bucket Region"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-the-content-of-a-bucket",children:"Listing the Content of a Bucket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#syncing-a-local-folder-with-a-bucket",children:"Syncing a Local Folder with a Bucket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#copying-files",children:"Copying Files"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#copying-folders",children:"Copying Folders"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#removing-a-file-from-a-bucket",children:"Removing a File from a Bucket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#deleting-a-bucket",children:"Deleting a Bucket"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#emptying-a-bucket",children:"Emptying a Bucket"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#vpc",children:"VPC"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-a-vpc",children:"Creating A VPC"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#allowing-dns-hostnames",children:"Allowing DNS hostnames"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#subnets",children:"Subnets"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-a-subnet",children:"Creating A Subnet"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#auto-assigning-public-ips-to-instances-in-a-public-subnet",children:"Auto Assigning Public IPs To Instances In A Public Subnet"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#internet-gateway",children:"Internet Gateway"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-an-igw",children:"Creating An IGW"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#attaching-an-igw-to-a-vpc",children:"Attaching An IGW to A VPC"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#nat",children:"NAT"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setting-up-a-nat-gateway",children:"Setting Up A NAT Gateway"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#route-tables",children:"Route Tables"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-a-public-route-table",children:"Creating A Public Route Table"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#creating-a-private-route-tables",children:"Creating A Private Route Tables"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#cloudfront",children:"CloudFront"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#listing-distributions",children:"Listing Distributions"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#invalidating-files-from-a-distribution",children:"Invalidating Files From a Distribution"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#sync-a-local-folder-with-a-cloudfront-distribution",children:"Sync a Local Folder with a CLoudFront Distribution"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#sync-and-invalidate-at-the-same-time",children:"Sync and Invalidate at the Same Time:"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#rds",children:"RDS"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-databases",children:"List Databases"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-public-databases",children:"List Public Databases"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#list-non-protected-databases-deletionprotection",children:"List Non Protected Databases (DeletionProtection)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#describe-the-automated-backups-for-a-db-instance",children:"Describe the Automated Backups for a DB Instance"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-db-cluster",children:"Create a DB Cluster"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-db-instance",children:"Create a DB Instance"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-db-security-group",children:"Create a DB Security Group"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-read-replica",children:"Create a Read Replica"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-custom-db-cluster-endpoint",children:"Create a Custom DB Cluster Endpoint"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#apply-tag-to-a-db",children:"Apply Tag to a DB"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-cluster-snapshot",children:"Create a Cluster Snapshot"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-a-cloudwatch-alarm-for-a-db-instance",children:"Create a CloudWatch Alarm for a DB Instance"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"volumes",children:"Volumes"}),"\n",(0,a.jsx)(n.h2,{id:"describing-volumes",children:"Describing volumes"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes\n"})}),"\n",(0,a.jsx)(n.p,{children:"Describing filtered volumes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=status,Values=creating | available | in-use | deleting | deleted | error\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g, describing all deleted volumes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=status,Values=deleted\n"})}),"\n",(0,a.jsx)(n.p,{children:"Filters can be applied to the attachment status:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=attachment.status,Values=attaching | attached | detaching | detached\n"})}),"\n",(0,a.jsx)(n.p,{children:'e.g: describing all volumes with the status "attaching":'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=attachment.status,Values=attaching\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This is the generic form. Use --profile ",(0,a.jsx)(n.code,{children:"<your_profile_name> "}),", if you have multiple AWS profiles or accounts."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters Name:'tag:Name',Values: ['some_values'] --profile <your_profile_name>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describing-volumes-using-a-different-aws-user-profile",children:"Describing volumes using a different aws user profile"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=status,Values=in-use  --profile <your_profile_name>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"listing-available-volumes-ids",children:"Listing Available Volumes IDs"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=status,Values=available |grep VolumeId|awk '{print $2}' | tr '\\n|,|\"' ' '\n"})}),"\n",(0,a.jsx)(n.p,{children:'With "profile":'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-volumes --filters  Name=status,Values=available  --profile <your_profile_name>|grep VolumeId|awk '{print $2}' | tr '\\n|,|\"' ' '\n"})}),"\n",(0,a.jsx)(n.h2,{id:"deleting-a-volume",children:"Deleting a Volume"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 delete-volume --region <region> --volume-id <volume_id>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"deleting-unused-volumes-think-before-you-type--",children:"Deleting Unused Volumes.. Think Before You Type :-)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"for x in $(aws ec2 describe-volumes --filters  Name=status,Values=available  --profile <your_profile_name>|grep VolumeId|awk '{print $2}' | tr ',|\"' ' '); do aws ec2 delete-volume --region <region> --volume-id $x; done\n"})}),"\n",(0,a.jsx)(n.p,{children:'With "profile":'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"for x in $(aws ec2 describe-volumes --filters  Name=status,Values=available  --profile <your_profile_name>|grep VolumeId|awk '{print $2}' | tr ',|\"' ' '); do aws ec2 delete-volume --region <region> --volume-id $x --profile <your_profile_name>; done\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-snapshot",children:"Creating a Snapshot"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-snapshot --volume-id <vol-id>\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-snapshot --volume-id <vol-id> --description \"snapshot-$(date +'%Y-%m-%d_%H-%M-%S')\"\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-an-image-ami",children:"Creating an Image (AMI)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-image --instance-id <instance_id> --name \"image-$(date +'%Y-%m-%d_%H-%M-%S')\" --description \"image-$(date +'%Y-%m-%d_%H-%M-%S')\"\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-ami-without-rebooting-the-machine",children:"Creating AMI Without Rebooting the Machine"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-image --instance-id <instance_id> --name \"image-$(date +'%Y-%m-%d_%H-%M-%S')\" --description \"image-$(date +'%Y-%m-%d_%H-%M-%S')\" --no-reboot\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You are free to change the AMI name ",(0,a.jsx)(n.code,{children:"image-$(date +'%Y-%m-%d_%H-%M-%S')"})," to a name of your choice."]}),"\n",(0,a.jsx)(n.h1,{id:"amis",children:"AMIs"}),"\n",(0,a.jsx)(n.h2,{id:"listing-amis",children:"Listing AMI(s)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-images\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describing-amis",children:"Describing AMI(s)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-images --image-ids <image_id> --profile <profile> --region <region>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-images --image-ids ami-e24dfa9f --profile terraform --region eu-west-3\n"})}),"\n",(0,a.jsx)(n.h2,{id:"listing-amazon-amis",children:"Listing Amazon AMIs"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 describe-images --owners amazon \n"})}),"\n",(0,a.jsx)(n.h2,{id:"using-filters",children:"Using Filters"}),"\n",(0,a.jsx)(n.p,{children:"e.g: Describing Windows AMIs that are backed by Amazon EBS."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws ec2 describe-images --filters "Name=platform,Values=windows" "Name=root-device-type,Values=ebs"\n'})}),"\n",(0,a.jsx)(n.p,{children:"e.g: Describing Ubuntu AMIs"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws ec2 describe-images --filters "Name=name,Values=ubuntu*"\n'})}),"\n",(0,a.jsx)(n.h1,{id:"lambda",children:"Lambda"}),"\n",(0,a.jsx)(n.h2,{id:"list-functions",children:"List Functions"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda list-functions\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describe-a-function",children:"Describe a Function"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda get-function --function-name  my-function\n"})}),"\n",(0,a.jsx)(n.h2,{id:"invoke-a-function",children:"Invoke a Function"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws lambda invoke --function-name my-function --payload \'{ "name": "Bob" }\' response.json\n'})}),"\n",(0,a.jsx)(n.h2,{id:"update-a-function-code",children:"Update a Function Code"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda update-function-code --function-name  my-function --zip-file fileb://my-function.zip\n"})}),"\n",(0,a.jsx)(n.h2,{id:"publish-a-version",children:"Publish a Version"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda publish-version --function-name my-function\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-layers",children:"List Layers"}),"\n",(0,a.jsx)(n.p,{children:"Let's take this example in which we want to list information of layers that are compatible with Python 3.7 runtime."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda list-layers --compatible-runtime python3.7\n"})}),"\n",(0,a.jsx)(n.p,{children:"Possible layers runtime:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"nodejs\nnodejs4.3\nnodejs6.10\nnodejs8.10\nnodejs10.x\nnodejs12.x\njava8\njava8.al2\njava11\npython2.7\npython3.6\npython3.7\npython3.8\ndotnetcore1.0\ndotnetcore2.0\ndotnetcore2.1\ndotnetcore3.1\nnodejs4.3-edge\ngo1.x\nruby2.5\nruby2.7\nprovided\nprovided.al2\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-aliases-of-a-function",children:"List Aliases of a Function"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda list-aliases --function-name my-function\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describe-an-alias",children:"Describe an Alias"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda get-alias --function-name my-function --name LIVE\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-an-alias",children:"Create an Alias"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws lambda create-alias --function-name my-function --description "alias description goes here" --function-version 1 --name LIVE\n'})}),"\n",(0,a.jsx)(n.h2,{id:"delete-an-alias",children:"Delete an Alias"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda delete-alias --function-name my-function --name LIVE\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-function-tags",children:"List Function Tags"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda list-tags --resource arn:aws:lambda:eu-west-1:xxxxxxxxxxx:function:my-function\n"})}),"\n",(0,a.jsx)(n.h2,{id:"delete-a-function",children:"Delete a Function"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws lambda delete-function --function-name my-function\n"})}),"\n",(0,a.jsx)(n.h2,{id:"using-aws-lambda-with-scheduled-events",children:"Using AWS Lambda with Scheduled Events"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sid=Sid$(date +%Y%m%d%H%M%S); aws lambda add-permission --statement-id $sid --action 'lambda:InvokeFunction' --principal events.amazonaws.com --source-arn arn:aws:events:<region>:<arn>:rule/AWSLambdaBasicExecutionRole --function-name function:<awsents> --region <region>\n"})}),"\n",(0,a.jsx)(n.h2,{id:""}),"\n",(0,a.jsx)(n.h1,{id:"iam",children:"IAM"}),"\n",(0,a.jsx)(n.h2,{id:"list-users",children:"List Users"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-users\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-policies",children:"List Policies"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-policies\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-groups",children:"List Groups"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-groups\n"})}),"\n",(0,a.jsx)(n.h2,{id:"get-users-in-a--group",children:"Get Users in a  Group"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam get-group --group-name <group_name>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describing-a-policy",children:"Describing a Policy"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam get-policy --policy-arn arn:aws:iam::aws:policy/<policy_name>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-access-keys",children:"List Access Keys"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-access-keys\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-keys",children:"List Keys"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-access-keys\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-the-access-key-ids-for-an-iam-user",children:"List the Access Key IDs for an IAM User"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-access-keys --user-name <user_name>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-the-ssh-public-keys-for-a-user",children:"List the SSH Public Keys for a User"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws iam list-ssh-public-keys --user-name <user_name>\n"})}),"\n",(0,a.jsx)(n.h1,{id:"s3-api",children:"S3 API"}),"\n",(0,a.jsx)(n.h2,{id:"listing-buckets",children:"Listing Buckets"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api list-buckets\n"})}),"\n",(0,a.jsx)(n.p,{children:"Or"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 ls\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 ls --profile eon01\n"})}),"\n",(0,a.jsx)(n.h2,{id:"listing-only-bucket-names",children:"Listing Only Bucket Names"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api list-buckets --query 'Buckets[].Name'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"getting-a-bucket-region",children:"Getting a Bucket Region"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api get-bucket-location --bucket <bucket_name>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api get-bucket-location --bucket practicalaws.com\n"})}),"\n",(0,a.jsx)(n.h2,{id:"listing-the-content-of-a-bucket",children:"Listing the Content of a Bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 ls s3://<bucket_name> --region <region>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 ls s3://practicalaws.com\n\naws s3 ls s3://practicalaws.com --region eu-west-1\n \naws s3 ls s3://practicalaws.com --region eu-west-1 --profile eon01\n"})}),"\n",(0,a.jsx)(n.h2,{id:"syncing-a-local-folder-with-a-bucket",children:"Syncing a Local Folder with a Bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 sync <local_path> s3://<bucket_name> \n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 sync . s3://practicalaws.com --region eu-west-1\n"})}),"\n",(0,a.jsx)(n.h2,{id:"copying-files",children:"Copying Files"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 cp <file_name> s3://<bucket_name>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Or:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 cp <file_name> s3://<bucket_name>/<folder_name>/\n"})}),"\n",(0,a.jsx)(n.p,{children:'To copy all files from a filder, look at "Copying Folders". Or use the following example, where I copy the content of the folder "images (contains images) in the remote folder "images".'}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd images\naws s3 cp . s3://saltstackfordevops.com/images --recursive --region us-east-2\n"})}),"\n",(0,a.jsx)(n.h2,{id:"copying-folders",children:"Copying Folders"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 cp <folder_name>/ s3://<bucket_name>/ --recursive\n"})}),"\n",(0,a.jsx)(n.p,{children:"To exclude files:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws s3 cp <folder_name>/ s3://<bucket_name>/ --recursive --exclude "<file_name_or_a_wildcard>" \n'})}),"\n",(0,a.jsx)(n.p,{children:"e.g: To only include a certain type of files (PNG) and exclude others (JPG)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws s3 cp practicalaws.com/ s3://practicalaws-backup/  --recursive --exclude "*.jpg"  --include "*.png"\n'})}),"\n",(0,a.jsx)(n.p,{children:"e.g: To exclude a folder"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws s3 cp practicalaws.com/ s3://practicalaws-backup/ --recursive --exclude ".git/*" \n'})}),"\n",(0,a.jsx)(n.h2,{id:"removing-a-file-from-a-bucket",children:"Removing a File from a Bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rm s3://<bucket_name>/<object_name>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rm s3://practicalaws.com/temp.txt\n"})}),"\n",(0,a.jsx)(n.h2,{id:"deleting-a-bucket",children:"Deleting a Bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rb s3://<bucket_name> --force\n"})}),"\n",(0,a.jsx)(n.p,{children:"If the bucket is not empty, use --force."}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rb s3://practicalaws.com --force  \n"})}),"\n",(0,a.jsx)(n.h2,{id:"emptying-a-bucket",children:"Emptying a Bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rm s3://<bucket_name>/<key_name> --recursive\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.p,{children:"In order to remove tempfiles/file1.txt and tempfiles/file2.txt from practicalaws.com bucket, use:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rm s3://practicalaws.com/tempfiles --recursive\n"})}),"\n",(0,a.jsx)(n.p,{children:"Remove all objects using:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 rm s3://practicalaws.com/tempfiles\n"})}),"\n",(0,a.jsx)(n.h2,{id:"making-a-public-file-private",children:"Making a Public File Private"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api put-object-acl --acl private --bucket <bucket-name> --key <file_name or file_path>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3api put-object-acl --acl private --bucket practicalaws.com --key image/logo.png\n"})}),"\n",(0,a.jsx)(n.h2,{id:"making-a-public-bucket-private",children:"Making a Public bucket Private"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 ls --recursive s3://<bucket-name> | cut -d' ' -f5- | awk '{print $NF}' | while read line; do\n    echo \"$line\"\n    aws s3api put-object-acl --acl private --bucket <bucket-name> --key \"$line\"\ndone\n"})}),"\n",(0,a.jsx)(n.h1,{id:"vpc",children:"VPC"}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-vpc",children:"Creating A VPC"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-vpc --cidr-block <cidr_block> --regiosn <region>\n"})}),"\n",(0,a.jsx)(n.p,{children:"e.g"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-vpc --cidr-block 10.0.0.0/16 --region eu-west-1\n"})}),"\n",(0,a.jsx)(n.h2,{id:"allowing-dns-hostnames",children:"Allowing DNS hostnames"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws ec2 modify-vpc-attribute --vpc-id <vpc_id> --enable-dns-hostnames "{\\"Value\\":true}" --region <region>\n'})}),"\n",(0,a.jsx)(n.h1,{id:"subnets",children:"Subnets"}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-subnet",children:"Creating A Subnet"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-subnet --vpc-id <vpc_id> --cidr-block <cidr_block> --availability-zone <availability_zone> --region <region>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"auto-assigning-public-ips-to-instances-in-a-public-subnet",children:"Auto Assigning Public IPs To Instances In A Public Subnet"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 modify-subnet-attribute --subnet-id <subnet_id> --map-public-ip-on-launch --region <region>\n"})}),"\n",(0,a.jsx)(n.h1,{id:"internet-gateway",children:"Internet Gateway"}),"\n",(0,a.jsx)(n.h2,{id:"creating-an-igw",children:"Creating An IGW"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-internet-gateway --region <region>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"attaching-an-igw-to-a-vpc",children:"Attaching An IGW to A VPC"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 attach-internet-gateway --internet-gateway-id <igw_id> --vpc-id <vpc_id> --region <region>\n"})}),"\n",(0,a.jsx)(n.h1,{id:"nat",children:"NAT"}),"\n",(0,a.jsx)(n.h2,{id:"setting-up-a-nat-gateway",children:"Setting Up A NAT Gateway"}),"\n",(0,a.jsx)(n.p,{children:"Allocate Elastic IP"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 allocate-address --domain vpc --region <region> \n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"then use the AllocationId to create the NAT Gateway for the public zone in <region>\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-nat-gateway --subnet-id <subnet_id> --allocation-id <allocation_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.h1,{id:"route-tables",children:"Route Tables"}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-public-route-table",children:"Creating A Public Route Table"}),"\n",(0,a.jsx)(n.p,{children:"Create the Route Table:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-route-table --vpc-id <vpc_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.p,{children:"then create a route for an Internet Gateway."}),"\n",(0,a.jsx)(n.p,{children:"Now, use the outputted Route Table ID:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-route --route-table-id <route_table_id> --destination-cidr-block 0.0.0.0/0 --gateway-id <igw_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.p,{children:"Finally, associate the public subnet with the Route Table"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 associate-route-table --route-table-id <route_table_id> --subnet-id <subnet_id> --region <region>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-private-route-tables",children:"Creating A Private Route Tables"}),"\n",(0,a.jsx)(n.p,{children:"Create the Route Table"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-route-table --vpc-id <vpc_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.p,{children:"then create a route that points to a NAT Gateway"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 create-route --route-table-id <route_table_id> --destination-cidr-block 0.0.0.0/0 --nat-gateway-id <net_gateway_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.p,{children:"Finally, associate the subnet"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws ec2 associate-route-table --route-table-id <route_table_id> --subnet-id <subnet_id> --region <region> \n"})}),"\n",(0,a.jsx)(n.h1,{id:"cloudfront",children:"CloudFront"}),"\n",(0,a.jsx)(n.h2,{id:"listing-distributions",children:"Listing Distributions"}),"\n",(0,a.jsx)(n.p,{children:"In some cases, you need to setup this first:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws configure set preview.cloudfront true\n"})}),"\n",(0,a.jsx)(n.p,{children:"Then:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws cloudfront list-distributions\n"})}),"\n",(0,a.jsx)(n.h2,{id:"invalidating-files-from-a-distribution",children:"Invalidating Files From a Distribution"}),"\n",(0,a.jsx)(n.p,{children:"To invalidate index and error HTML files from the distribution with the ID Z2W2LX9VBMAPRX:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws cloudfront create-invalidation --distribution-id Z2W2LX9VBMAPRX  --paths /index.html /error.html\n"})}),"\n",(0,a.jsx)(n.p,{children:"To invalidate everything in the distribution:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws cloudfront create-invalidation --distribution-id Z2W2LX9VBMAPRX  --paths '/*'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"sync-a-local-folder-with-a-cloudfront-distribution",children:"Sync a Local Folder with a CLoudFront Distribution"}),"\n",(0,a.jsx)(n.p,{children:'CloudFront is "attached" to a bucket, you need to upload your files to the bucket.'}),"\n",(0,a.jsx)(n.p,{children:"e.g.:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 sync . s3://my-bucket.com\n"})}),"\n",(0,a.jsx)(n.p,{children:"If you should keep the files public:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 sync . s3://my-bucket.com --acl public-read\n"})}),"\n",(0,a.jsx)(n.p,{children:"To copy a single file, you need to:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 cp file1 s3://my-bucket.com/sub-folder/ --acl <ACL>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"sync-and-invalidate-at-the-same-time",children:"Sync and Invalidate at the Same Time:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 sync . s3://my-bucket.com --acl public-read && aws cloudfront create-invalidation --distribution-id Z2W2LX9VBMAPRX  --paths '/*'\n"})}),"\n",(0,a.jsx)(n.p,{children:"or in case you want to update a single file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws s3 cp file1 s3://my-bucket.com/sub-folder/ --acl public-read && aws cloudfront create-invalidation --distribution-id Z2W2LX9VBMAPRX  --paths '/sub-folder/file1'\n"})}),"\n",(0,a.jsx)(n.h1,{id:"rds",children:"RDS"}),"\n",(0,a.jsx)(n.h2,{id:"list-databases",children:"List Databases"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds describe-db-instances\n"})}),"\n",(0,a.jsx)(n.p,{children:"or:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds describe-db-instances --query 'DBInstances[].DBInstanceIdentifier'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-public-databases",children:"List Public Databases"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds describe-db-instances --query 'DBInstances[?PubliclyAccessible==\"true\"].[DBInstanceIdentifier,Endpoint.Address]'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-non-protected-databases-deletionprotection",children:"List Non Protected Databases (DeletionProtection)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds describe-db-instances \\\n    --query 'DBInstances[*].[DBInstanceIdentifier]' \\\n    --output text \\\n    | xargs -I {} bash -c 'if [[ $(aws rds describe-db-instances --db-instance-identifier {} --query '\"'\"'DBInstances[*].DeletionProtection'\"'\"' --output text) == False ]]; then echo {} ; fi'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"describe-the-automated-backups-for-a-db-instance",children:"Describe the Automated Backups for a DB Instance"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds describe-db-instance-automated-backups --db-instance-identifier database-mysql\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-db-cluster",children:"Create a DB Cluster"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds create-db-cluster \\\n    --db-cluster-identifier mysql-cluster \\\n    --engine aurora-mysql \\\n    --engine-version 5.7.12 \\\n    --master-username master \\\n    --master-user-password xxxxxx \\\n    --db-subnet-group-name default \\\n    --vpc-security-group-ids sg-0130572b9daf3dc16\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-db-instance",children:"Create a DB Instance"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds create-db-instance \\\n    --db-instance-identifier mysql-instance \\\n    --db-instance-class db.t3.micro \\\n    --engine mysql \\\n    --master-username admin \\\n    --master-user-password xxxxx \\\n    --allocated-storage 40\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-db-security-group",children:"Create a DB Security Group"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws rds create-db-security-group --db-security-group-name my-security-group --db-security-group-description "My Security Group"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-read-replica",children:"Create a Read Replica"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds create-db-instance-read-replica \\\n    --db-instance-identifier test-instance-repl \\\n    --source-db-instance-identifier test-instance\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-custom-db-cluster-endpoint",children:"Create a Custom DB Cluster Endpoint"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds create-db-cluster-endpoint \\\n    --db-cluster-endpoint-identifier mycustomendpoint \\\n    --endpoint-type reader \\\n    --db-cluster-identifier mydbcluster \\\n    --static-members dbinstance1 dbinstance2\n"})}),"\n",(0,a.jsx)(n.h2,{id:"apply-tag-to-a-db",children:"Apply Tag to a DB"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws rds add-tags-to-resource \\\n    --resource-name arn:aws:rds:us-east-1:123456789012:db:database-mysql \\\n    --tags "[{\\"Key\\": \\"Name\\",\\"Value\\": \\"MyDatabase\\"},{\\"Key\\": \\"Environment\\",\\"Value\\": \\"test\\"}]"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-cluster-snapshot",children:"Create a Cluster Snapshot"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"aws rds create-db-cluster-snapshot --db-cluster-identifier my-db-cluster --db-cluster-snapshot-identifier my-db-cluster-snapshot\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-a-cloudwatch-alarm-for-a-db-instance",children:"Create a CloudWatch Alarm for a DB Instance"}),"\n",(0,a.jsxs)(n.p,{children:["e.g.:  When ",(0,a.jsx)(n.strong,{children:"average CPU for latest 15 minutes is above 90%"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'aws cloudwatch put-metric-alarm \\\n    --alarm-name "my-alarm" \\\n    --metric-name "CPUUtilization" \\\n    --namespace "AWS/RDS" \\\n    --statistic "Average" \\\n    --period 300 \\\n    --evaluation-periods 3 \\\n    --threshold 90.0 \\\n    --comparison-operator "GreaterThanOrEqualToThreshold" \\\n    --dimensions "Name=DBInstanceIdentifier,Value=my-db-instance" \\\n    --alarm-actions "<arn of sns resource>"\n'})}),"\n",(0,a.jsx)(n.p,{children:"This will monitor the DB instance during a period of 300 seconds (5 minutes) during 3 evaluation periods: 5*3 = 15 minutes."}),"\n",(0,a.jsx)(n.p,{children:"If in the three periods, the average is equal or more than 90%, then the alarm will trigger the SNS resource."}),"\n",(0,a.jsx)(n.p,{children:"You should subscribe to the SNS resource you create by email or SMS."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var s=i(6540);const a={},r=s.createContext(a);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);