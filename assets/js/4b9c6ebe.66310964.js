"use strict";(self.webpackChunkjodichris_com=self.webpackChunkjodichris_com||[]).push([[573],{2918:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"linux-network-cheatsheet","title":"Network Cheatsheet","description":"Published on November 30, 2020","source":"@site/docs/linux-network-cheatsheet.md","sourceDirName":".","slug":"/linux-network-cheatsheet","permalink":"/docs/linux-network-cheatsheet","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Network Cheatsheet"},"sidebar":"docs","previous":{"title":"Reading List","permalink":"/docs/reading-list"},"next":{"title":"Cisco Cheatsheet","permalink":"/docs/cisco-cheatsheet"}}');var t=i(4848),l=i(8453);const r={title:"Network Cheatsheet"},a="Networking Cheat Sheet",o={},c=[{value:"Sniff Network Traffic from / to IP",id:"sniff-network-traffic-from--to-ip",level:2},{value:"Create Routes",id:"create-routes",level:2},{value:"Show Routes",id:"show-routes",level:2},{value:"Trace Routes",id:"trace-routes",level:2},{value:"Show Ports",id:"show-ports",level:2},{value:"Basics",id:"basics",level:2},{value:"Basic Commands",id:"basic-commands",level:2},{value:"List Rules",id:"list-rules",level:3},{value:"List Commands to configure a Chain",id:"list-commands-to-configure-a-chain",level:3},{value:"Adding a route",id:"adding-a-route",level:3},{value:"Adding a default Policy",id:"adding-a-default-policy",level:3},{value:"Deleting a default Policy",id:"deleting-a-default-policy",level:3},{value:"Flushing current Rules",id:"flushing-current-rules",level:3},{value:"Debugging",id:"debugging",level:2},{value:"Digital Ocean Tutorial on iptables",id:"digital-ocean-tutorial-on-iptables",level:2},{value:"iptables in general",id:"iptables-in-general",level:2},{value:"Networking in general",id:"networking-in-general",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Published on November 30, 2020"}),"\n",(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"networking-cheat-sheet",children:"Networking Cheat Sheet"})}),"\n",(0,t.jsx)(n.h2,{id:"sniff-network-traffic-from--to-ip",children:"Sniff Network Traffic from / to IP"}),"\n",(0,t.jsx)(n.p,{children:"tcpdump -n -i eth0 src SRC_IP  or dst DEST_IP"}),"\n",(0,t.jsx)(n.h2,{id:"create-routes",children:"Create Routes"}),"\n",(0,t.jsx)(n.p,{children:"sudo route add -net DESTINATION gateway GATEWAY\nsudo route add -net DESTINATION if INTERFACE"}),"\n",(0,t.jsx)(n.h2,{id:"show-routes",children:"Show Routes"}),"\n",(0,t.jsx)(n.p,{children:"netstat -rn"}),"\n",(0,t.jsx)(n.h2,{id:"trace-routes",children:"Trace Routes"}),"\n",(0,t.jsxs)(n.p,{children:["tracerouts ",(0,t.jsx)(n.code,{children:"<ADDRESS>"})]}),"\n",(0,t.jsx)(n.h2,{id:"show-ports",children:"Show Ports"}),"\n",(0,t.jsx)(n.p,{children:"sudo netstat -tulpn"}),"\n",(0,t.jsx)(n.h1,{id:"iptables",children:"iptables"}),"\n",(0,t.jsx)(n.h2,{id:"basics",children:"Basics"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"iptables"})," organizes firewalls in ",(0,t.jsx)(n.em,{children:"chains"})," (",(0,t.jsx)(n.code,{children:"INPUT"}),", ",(0,t.jsx)(n.code,{children:"OUTPUT"}),", ",(0,t.jsx)(n.code,{children:"FORWARD"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["each chain contains a set of ",(0,t.jsx)(n.em,{children:"rules"}),". A rule defines","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a protocol type"}),"\n",(0,t.jsx)(n.li,{children:"a source address"}),"\n",(0,t.jsx)(n.li,{children:"a destination address"}),"\n",(0,t.jsx)(n.li,{children:"an interface"}),"\n",(0,t.jsx)(n.li,{children:"..."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["a ",(0,t.jsx)(n.em,{children:"packet"})," either matches a rule or not"]}),"\n",(0,t.jsxs)(n.li,{children:["if a rule is matched, the associated action is taken - this action is called a ",(0,t.jsx)(n.em,{children:"target"}),". A target can be","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"ACCEPT"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"DROP"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"rules are processed in the order of appearence within a chain"}),"\n",(0,t.jsxs)(n.li,{children:["each chain has a ",(0,t.jsx)(n.em,{children:"default policy"})," that matches if no rule matches"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"basic-commands",children:"Basic Commands"}),"\n",(0,t.jsx)(n.h3,{id:"list-rules",children:"List Rules"}),"\n",(0,t.jsx)(n.p,{children:"iptables -n -L          # -n = disables DNS"}),"\n",(0,t.jsxs)(n.p,{children:["use ",(0,t.jsx)(n.code,{children:"--list-numbers"})," to show the numbers of rules in a chain."]}),"\n",(0,t.jsx)(n.h3,{id:"list-commands-to-configure-a-chain",children:"List Commands to configure a Chain"}),"\n",(0,t.jsx)(n.p,{children:"iptables -S INPUT"}),"\n",(0,t.jsxs)(n.p,{children:["shows all commands necessary to set up the ",(0,t.jsx)(n.code,{children:"INPUT"})," chain"]}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-route",children:"Adding a route"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"iptables \n  -A INPUT        = append\n  -I INPUT <pos>  = insert\n      -j      target (e.g. ACCEPT, DROP...)\n      -p      protocol, e.g. tcp\n      -dport  destination port, e.g. 80\n      -i      interface name\n"})}),"\n",(0,t.jsx)(n.h3,{id:"adding-a-default-policy",children:"Adding a default Policy"}),"\n",(0,t.jsx)(n.p,{children:"iptables -P INPUT DROP"}),"\n",(0,t.jsxs)(n.p,{children:["Adds a ",(0,t.jsx)(n.code,{children:"DROP"})," policy to the ",(0,t.jsx)(n.code,{children:"INPUT"}),"chain"]}),"\n",(0,t.jsx)(n.h3,{id:"deleting-a-default-policy",children:"Deleting a default Policy"}),"\n",(0,t.jsxs)(n.p,{children:["Before you can delete a policy ",(0,t.jsx)(n.strong,{children:"there must be no more rules in the policy"}),". Afterwards, it's"]}),"\n",(0,t.jsx)(n.p,{children:"iptables -X INPUT"}),"\n",(0,t.jsx)(n.h3,{id:"flushing-current-rules",children:"Flushing current Rules"}),"\n",(0,t.jsx)(n.p,{children:"iptables rules are not persistent - therefore you can flush the rules with"}),"\n",(0,t.jsx)(n.p,{children:"iptables -F"}),"\n",(0,t.jsxs)(n.p,{children:["Remind that ",(0,t.jsx)(n.strong,{children:"policies are not flushed"})]}),"\n",(0,t.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,t.jsxs)(n.p,{children:["Althought there exist several logging mechanisms for iptables (see ",(0,t.jsx)(n.a,{href:"#further_resources",children:"Further Resources"}),") this will not work, unless you have the ",(0,t.jsx)(n.code,{children:"ipt_LOG"})," module installed on your kernel."]}),"\n",(0,t.jsx)(n.p,{children:"Therefore this can be a workaround to see what's happening with your packets:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"watch"})," the ",(0,t.jsx)(n.code,{children:"iptables -L"})," command with"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"watch -n 0.1 sudo iptables -L -n -v\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Ping some host - you'll now see the packet counter of the affected rules increasing"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"further-resources",children:"Further Resources"}),"\n",(0,t.jsx)(n.h2,{id:"digital-ocean-tutorial-on-iptables",children:"Digital Ocean Tutorial on iptables"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-the-iptables-firewall-works",children:"How the iptables Firewall works (Digital Ocean)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-iptables-on-ubuntu-14-04",children:"How to set up a Firewall using iptables (Digital Ocean)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/iptables-essentials-common-firewall-rules-and-commands",children:"iptables Essentials (Digital Ocean)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-list-and-delete-iptables-firewall-rules",children:"How to list and delete iptables Firewall Rules (Digital Ocean)"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"iptables-in-general",children:"iptables in general"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://www.thegeekstuff.com/2012/08/iptables-log-packets/?utm_source=feedburner",children:"Logging Dropped Packages"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://backreference.org/2010/06/11/iptables-debugging/",children:"iptables debugging with trace"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://inai.de/images/nf-packet-flow.png",children:"iptables flow diagram"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://serverfault.com/questions/158772/can-you-recommend-a-good-intro-to-iptables",children:"Question for good iptables tutorials on Stack Overflow"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"networking-in-general",children:"Networking in general"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://linux-ip.net/html/routing-intro.html",children:"Introduction to Linux Routing"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var s=i(6540);const t={},l=s.createContext(t);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);